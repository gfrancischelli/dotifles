import React, {Component, PropTypes} from 'react';
import ReactDOM from 'react-dom';
import moment from 'moment';
import './index.css';
import testTweet from './dummy';

class Tweet extends Component {
  render() {
    const {tweet} = this.props;
    return (
        <div className='tweet'>
        <Avatar hash={ tweet.gravatar } />
        <div className='content'>
          <NameWithHandle author={ tweet.author } />
          <Time time={ tweet.timestamp } />
          <Message message={ tweet.message } />
          <div className='buttons'>
            <ReplyButton />
            <RetweetButton  count={ tweet.retweets }/>
            <LikeButton count={ tweet.likes } />
            <MoreOptionsButton />
          </div>
        </div>
      </div>
    )
  }
}

class Avatar extends Component {
  render() {
    const hash = this.props.hash;
    const url = `https://www.gravatar.com/avatar/${ hash }`;
    return (
      <img src={ url }
        className="avatar"
        alt="avatar" />
    );
  }
}

class Message extends Component {
  render() {
    return (
      <div className='message'>
        { this.props.message }
      </div>
    )
  }
}

class NameWithHandle extends Component {
  render() {
    const {name, handle} = this.props.author;
    return (
      <span className='name-with-handle'>
        <span className='name'>{ name }</span>
        <span className='handle'>{ handle }</span>
      </span>
    )
  }
}

NameWithHandle.propTypes = {
  author: PropTypes.shape({
    name: PropTypes.string.isRequired,
    handle: PropTypes.string.IsRequired,
  }).isRequired,
};

class ReplyButton extends Component {
  render() {
    return (
      <i className='fa fa-reply reply-button' />
    )
  }
}

class RetweetButton extends Component {
  getCount() {
    if (this.props.count > 0 ) {
      return (
        <span className='retweet-count'>
          { this.props.count }
        </span>
      );
    } else {
      return null
    }
  }

  render() {
    return ( 
      <span className='retweet-button'>
        <i className='fa fa-retweet' />
        { this.getCount() }
      </span>
    )
  }
}

class LikeButton extends Component {
  render() {
    const {count} = this.props;
    console.log(count)
    return ( 
      <span className='like-button'>
        <i className='fa fa-heart' />
        { count > 0 ?
          <span className='like-count'> { count } </span>
          : null }
      </span>
    )
  }
}

LikeButton.propTypes = {
  count: PropTypes.number,
};

class MoreOptionsButton extends Component {
  render() {
    return (
      <i className='fa fa-ellipsis-h more-options-button' />
    )
  }
}


ReactDOM.render(
  <Tweet  tweet={ testTweet } />,
  document.getElementById('root')
)
